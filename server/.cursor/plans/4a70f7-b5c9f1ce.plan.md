<!-- b5c9f1ce-a4f2-4e55-bddc-7453721acf62 0281b229-ad90-47ba-8904-d929ace3b53d -->
# 웹 앱 EDA/드리프트 분석 강화 계획 (1차)

**날짜**: 2025년 11월 28일

---

## 1차 작업 범위

**목표**: ddoc-plugin-vision의 분석 로직을 활용하여 웹 앱의 EDA/드리프트 분석 및 시각화 기능 강화

**범위 외 (2차 작업으로 연기)**:

- ddoc 워크스페이스 연동
- 데이터셋 내보내기/가져오기
- 스냅샷/계보 관리
- CLI subprocess 호출

---

## Step 1: 백엔드 의존성 및 기반 설정

### 1-1. ddoc-plugin-vision 의존성 추가

- [`backend/requirements.txt`](backend/requirements.txt)에 추가:
- `ddoc-plugin-vision` (또는 로컬 경로 설치)
- 필요시 `torch`, `clip` 관련 의존성

### 1-2. 분석기 초기화 서비스

- 새 파일 `backend/app/services/analyzer_init.py` 생성
- AttributeAnalyzer, EmbeddingAnalyzer 싱글톤 초기화
- 모델 로딩 지연(lazy loading) 처리

---

## Step 2: EDA 서비스 강화

### 2-1. eda_service.py 수정

- [`backend/app/services/eda_service.py`](backend/app/services/eda_service.py) 수정
- ZIP 타입 데이터셋에 대해:
- 이미지 속성 분석 (크기, 노이즈, 선명도, 품질 점수)
- CLIP 임베딩 추출
- K-means 클러스터링
- 반환 데이터 구조 확장

### 2-2. EDA API 응답 확장

- [`backend/app/routers/eda.py`](backend/app/routers/eda.py) 수정
- 새로운 분석 결과 필드 추가

---

## Step 3: 드리프트 서비스 강화

### 3-1. drift_service.py 수정

- [`backend/app/services/drift_service.py`](backend/app/services/drift_service.py) 수정
- 앙상블 드리프트 메트릭 추가:
- KL Divergence (속성별)
- MMD (임베딩)
- Wasserstein Distance
- PSI
- 상태 판정 (NORMAL/WARNING/CRITICAL)

### 3-2. 드리프트 API 응답 확장

- [`backend/app/routers/drift.py`](backend/app/routers/drift.py) 수정

---

## Step 4: 프론트엔드 시각화

### 4-1. 차트 라이브러리 설정

- `frontend/package.json`에 Recharts 추가
- 공통 차트 스타일 설정

### 4-2. EDAStudio 시각화 강화

- [`frontend/src/components/EDAStudio.jsx`](frontend/src/components/EDAStudio.jsx) 수정
- 차트 추가:
- 파일 크기 분포 (히스토그램)
- 포맷 분포 (파이 차트)
- 노이즈 vs 선명도 (산점도)
- 클러스터 분포 (2D 산점도)
- 품질 점수 분포

### 4-3. DriftStudio 시각화 강화

- [`frontend/src/components/DriftStudio.jsx`](frontend/src/components/DriftStudio.jsx) 수정
- 차트 추가:
- 속성별 분포 비교 (overlay 히스토그램)
- 드리프트 점수 바 차트
- 상태 표시 배지

---

## 주요 파일 변경

| 파일 | 작업 |
|------|------|
| `backend/requirements.txt` | 의존성 추가 |
| `backend/app/services/analyzer_init.py` | 신규 생성 |
| `backend/app/services/eda_service.py` | 분석 로직 통합 |
| `backend/app/services/drift_service.py` | 앙상블 메트릭 추가 |
| `backend/app/routers/eda.py` | 응답 확장 |
| `backend/app/routers/drift.py` | 응답 확장 |
| `frontend/package.json` | Recharts 추가 |
| `frontend/src/components/EDAStudio.jsx` | 차트 추가 |
| `frontend/src/components/DriftStudio.jsx` | 차트 추가 |

---

## 2차 작업 예정 (TODO)

- [ ] ddoc 워크스페이스 관리 서비스
- [ ] 데이터셋 내보내기 API 및 UI
- [ ] ddoc CLI subprocess 호출 래퍼
- [ ] 스냅샷/계보 조회 및 시각화
- [ ] 데이터 변형(샘플링, 증강) 연동
- [ ] 실험(모델 훈련/평가) 연동

### To-dos

- [ ] ddoc-plugin-vision 의존성 추가 및 초기화 로직 구현
- [ ] EDA 서비스에 이미지 속성/임베딩/클러스터링 분석 통합
- [ ] 드리프트 서비스에 앙상블 메트릭(KL, MMD, PSI 등) 추가
- [ ] EDA/드리프트 API 응답 확장 및 ddoc 연동 API 추가
- [ ] 프론트엔드에 Recharts 추가 및 EDA/드리프트 시각화 구현